#include "new.ch"
Function Ind(var)
LOCAL m_path:=IF(var==NIL,"D:\BUHGAL\SP\",var)
LOCAL m_gauge:=INitGauge("Iндексацiя довiдникiв",2)
LOCAL n:=32,i:=0,m_str
SETBLINK(.f.)
SET CURSOR OFF
m_str:=DispMessag("Iндексацiя SP01")
USE (m_path+"sp01") NEW;INDEX ON field->brgd TO (m_path+"sp01")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP02")
USE (m_path+"sp02");INDEX ON field->mol TO (m_path+"sp02")
USE (m_path+"sp10") INDEX (m_path+"sp10") NEW
SELE Sp02
set rela to sP02->tabn INTO Sp10
INDEX ON UPPER(Sp10->fam+Sp10->imja+Sp10->otch) TO (m_path+"sp02a")
CLOSE Sp10
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP03")
USE (m_path+"sp03");INDEX ON field->kktg TO (m_path+"sp03")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP04")
USE (m_path+"sp04");INDEX ON field->kprof TO (m_path+"sp04")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP05")
USE (m_path+"sp05");INDEX ON field->kopr TO (m_path+"sp05")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP06")
USE (m_path+"sp06");INDEX ON field->vrab TO (m_path+"sp06")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя sp44")
USE (m_path+"sp44");INDEX ON field->ksash TO (m_path+"sp44")
INDEX ON LEFT(field->ksash,3)+UPPER(sp44->naim7) TO (m_path+"sp44a")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP08")
USE (m_path+"sp08");INDEX ON field->kopu TO (m_path+"sp08")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP09")
USE (m_path+"sp09");INDEX ON field->tabn + field->kopu TO (m_path+"sp09")
INDEX ON field->kopu+ field->tabn TO (m_path+"sp09a")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP10")
USE (m_path+"sp10");INDEX ON field->tabn TO (m_path+"sp10")
INDEX ON UPPER(field->fam)+UPPER(field->imja)+UPPER(field->otch) TO (m_path+"sp10a")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
IF FILE(m_path+"sp11.dbf")
m_str:=DispMessag("Iндексацiя SP11")
  USE (m_path+"sp11");INDEX ON field->Sch TO (m_path+"sp11")
DelMessage(m_str)
ENDIF
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP13A")
USE (m_path+"sp13A");INDEX ON field->kavt TO (m_path+"sp13A")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP13b")
USE (m_path+"sp13B");INDEX ON field->kmtr TO (m_path+"sp13B")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP15")
USE (m_path+"sp15");INDEX ON field->tabn TO (m_path+"sp15")
DelMessage(m_str)
m_str:=DispMessag("Iндексацiя SP16")
USE (m_path+"sp16");INDEX ON field->amrt TO (m_path+"sp16")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP20")
USE (m_path+"sp20");INDEX ON field->year+field->gr TO (m_path+"sp20")
// m_str:=DispMessag("Iндексацiя SP21")
// USE (m_path+"sp21");INDEX ON field->month TO (m_path+"sp21")
// DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP22")
USE (m_path+"sp22");INDEX ON field->mnt + field->kmtop TO (m_path+"sp22")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP23")
USE (m_path+"sp23");INDEX ON field->tkm TO (m_path+"sp23")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP24")
USE (m_path+"sp24");INDEX ON field->dbt TO (m_path+"sp24")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP25")
USE (m_path+"sp25");INDEX ON field->kopu TO (m_path+"sp25")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя SP30")
USE (m_path+"sp30");INDEX ON field->dbt TO (m_path+"sp30")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя inv_a")
USE (m_path+"inv_a");INDEX ON field->gnavt TO (m_path+"inv_a")
INDEX ON field->tabn TO (m_path+"inv_aa")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя inv_p")
USE (m_path+"inv_p");INDEX ON field->gnavt TO (m_path+"inv_p")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя inv_t")
USE (m_path+"inv_t");INDEX ON field->invnum TO (m_path+"inv_t")
INDEX ON field->tabn TO (m_path+"inv_ta")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя inv_zd")
USE (m_path+"inv_zd");INDEX ON field->invnum TO (m_path+"inv_zd")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
DelMessage(m_str)
m_str:=DispMessag("Iндексацiя inv_mo")
USE (m_path+"inv_mo");INDEX ON field->invnum TO (m_path+"inv_mo")
m_gauge:=DispGauge(m_gauge,i++/n)
DelMessage(m_str)
m_str:=DispMessag("Iндексацiя inv_gv")
USE (m_path+"inv_gv");INDEX ON field->invnum TO (m_path+"inv_gv")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя inv_gr")
USE (m_path+"inv_gr");INDEX ON field->invnum TO (m_path+"inv_gr")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
m_str:=DispMessag("Iндексацiя inv_mn")
USE (m_path+"inv_mn");INDEX ON field->invnum TO (m_path+"inv_mn")
DelMessage(m_str)
m_gauge:=DispGauge(m_gauge,i++/n)
USE
SET CURSOR ON
RETURN ( NIL )
